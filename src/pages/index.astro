---
import BaseLayout from "../layouts/Layout.astro";
import { getCollection } from "astro:content";

const posts = await getCollection("blog").catch(() => []);
const projects = await getCollection("projects").catch(() => []);

const latestPosts = posts.sort((a, b) => new Date(b.data.date) - new Date(a.data.date)).slice(0, 3);
const featured = projects.filter(p => p.data.featured).slice(0, 6);
---
<BaseLayout title="Home">
  <section class="mb-12">
    <h1 class="text-3xl font-bold mb-3">Hi â€” I'm Abhishek Mohanty</h1>
    <p class="text-slate-600 dark:text-slate-400 text-lg">I write about frontend, performance, and building things.</p>
  </section>

  <section class="mb-12">
    <h2 class="text-2xl font-semibold mb-4">Latest Posts</h2>
    <div class="grid md:grid-cols-3 gap-6">
      {latestPosts.length ? latestPosts.map(post => (
        <article class="p-4 border border-slate-200 dark:border-slate-700 rounded-xl hover:shadow-sm transition">
          <a href={`/blog/${post.slug}`} class="text-lg font-semibold hover:text-sky-500">{post.data.title}</a>
          <p class="text-slate-500 mt-2 text-sm">{post.data.description}</p>
        </article>
      )) : <p class="text-slate-500">No posts yet.</p>}
    </div>
  </section>

  <section>
    <h2 class="text-2xl font-semibold mb-4">Featured Projects</h2>
    <div class="grid md:grid-cols-3 gap-6">
      {featured.length ? featured.map(p => (
        <article class="p-4 border border-slate-200 dark:border-slate-700 rounded-xl hover:shadow-sm transition">
          <a href={`/projects/${p.slug}`} class="text-lg font-semibold hover:text-sky-500">{p.data.title}</a>
          <p class="text-slate-500 mt-2 text-sm">{p.data.description}</p>
        </article>
      )) : <p class="text-slate-500">No projects yet.</p>}
    </div>
  </section>
</BaseLayout>
